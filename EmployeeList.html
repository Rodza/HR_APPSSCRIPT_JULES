<!-- Employee List -->
<div>
  <h2>Employee List</h2>
  <button onclick="addNewEmployee()">Add New Employee</button>
  <div class="filters">
    <input type="text" id="employee-search" placeholder="Search by name...">
    <select id="employer-filter">
      <option value="">All Employers</option>
      <option value="SA Grinding Wheels">SA Grinding Wheels</option>
      <option value="Scorpio Abrasives">Scorpio Abrasives</option>
    </select>
  </div>
  <table id="employee-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Surname</th>
        <th>Employer</th>
        <th>Hourly Rate</th>
        <th>Contact Number</th>
        <th>Employment Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <!-- Employee rows will be inserted here dynamically -->
    </tbody>
  </table>
</div>

<script>
  function fetchEmployees() {
    google.script.run.withSuccessHandler(displayEmployees).listEmployees();
  }

  function displayEmployees(employees) {
    var employeeTable = document.getElementById('employee-table');
    if (!employeeTable) {
      console.error('Employee table not found');
      return;
    }
    var tableBody = employeeTable.getElementsByTagName('tbody')[0];
    if (!tableBody) {
      console.error('Table body not found');
      return;
    }
    tableBody.innerHTML = '';

    if (!employees) {
      var row = tableBody.insertRow();
      var cell = row.insertCell();
      cell.colSpan = 7;
      cell.textContent = 'Error: Could not load employee data. The data source may be unavailable.';
      cell.style.textAlign = 'center';
      cell.style.color = 'red';
      return;
    }

    employees.forEach(function(employee) {
      var row = tableBody.insertRow();
      row.insertCell().textContent = employee['EMPLOYEE NAME'];
      row.insertCell().textContent = employee['SURNAME'];
      row.insertCell().textContent = employee['EMPLOYER'];
      row.insertCell().textContent = employee['HOURLY RATE'];
      row.insertCell().textContent = employee['CONTACT NUMBER'];
      row.insertCell().textContent = employee['EMPLOYMENT STATUS'];
      var actionsCell = row.insertCell();
      actionsCell.innerHTML = '<button onclick="viewEmployee(\'' + employee.ID + '\')">View</button> ' +
                              '<button onclick="editEmployee(\'' + employee.ID + '\')">Edit</button>';
    });
  }

  function addNewEmployee() {
    loadView('employee-add');
  }

  function viewEmployee(id) {
    loadView('employee-view', {id: id});
  }

  function editEmployee(id) {
    loadView('employee-edit', {id: id});
  }

  fetchEmployees();
</script>
